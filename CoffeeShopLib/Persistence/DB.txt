DROP DATABASE IF EXISTS coffeeshop;

CREATE SCHEMA coffeeshop;
USE coffeeshop;

CREATE TABLE Staffs (
staff_id INT AUTO_INCREMENT,
staff_name VARCHAR(50) NOT NULL,
user_name VARCHAR(50) NOT NULL,
password VARCHAR(150) NOT NULL,
role_id INT NOT NULL, -- 1 la bartender, 2 la cashier
status INT NOT NULL, -- 0 la dang hoat dong, 1 la tam dung hoat dong
PRIMARY KEY (staff_id)

) engine = InnoDB;

INSERT INTO Staffs(staff_name, user_name, password, role_id, status) VALUES ("Nguyen Duy Hung", "cashier", "202CB962AC59075B964B07152D234B70", 2, 0);
INSERT INTO Staffs(staff_name, user_name, password, role_id, status) VALUES ("Nguyen Duc Trung", "bartender", "202CB962AC59075B964B07152D234B70", 1, 0);

-- at thi la datetime, by la int, payment method la int, decimal cho gia tien d
CREATE TABLE Orders(
order_id INT AUTO_INCREMENT,
staff_id INT,
paymentmethod VARCHAR(20),
status INT,
create_at DATETIME DEFAULT CURRENT_TIMESTAMP(),
create_by INT,
update_at DATETIME,
PRIMARY KEY (order_id),
FOREIGN KEY (staff_id) REFERENCES Staffs(staff_id)
)engine = InnoDB;

INSERT INTO Orders(paymentmethod, status, create_at, create_by,update_at) VALUES ("cash", 0, CURRENT_TIMESTAMP(), 2, CURRENT_TIMESTAMP());
INSERT INTO Orders(paymentmethod, status, create_at, create_by,update_at) VALUES ("banking", 0, CURRENT_TIMESTAMP(), 2, CURRENT_TIMESTAMP());

CREATE TABLE Products(
product_id INT AUTO_INCREMENT,
product_name VARCHAR(50) NOT NULL,
description  VARCHAR(100),
product_status INT,
PRIMARY KEY (product_id)
)engine = InnoDB;

INSERT INTO Products(product_name, description, product_status) VALUES ("Phin sữa", "coffee with milk", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Phin đen", "black coffee", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Espresso ", "can be ordered hot or iced ", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Americano ", "can be ordered hot or iced", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Cappuccino ", "can be ordered hot or iced", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Caramel Macchiato/ Mocha ", "can be ordered hot or iced", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Caramel Phin Freeze", "freeze with coffee", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Hazelnut Phin Freeze", "freeze with coffee", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Green Tea Freeze", "freeze with coffee", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Chocolate Freeze", "freeze with coffee", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Peach Tea With Lemongrass", "tea", 0);
INSERT INTO Products(product_name, description, product_status) VALUES ("Lychee Tea", "tea", 0);


CREATE TABLE OrderDetails(
order_id INT AUTO_INCREMENT,
product_id INT,
product_name VARCHAR(50) NOT NULL,
product_quantity INT,
order_status INT,
price DECIMAL,
PRIMARY KEY ( order_id,product_id),
FOREIGN KEY (order_id) REFERENCES Orders(order_id),
FOREIGN KEY (product_id) REFERENCES Products(product_id)
)engine = InnoDB;

CREATE TABLE Sizes(
size_id INT AUTO_INCREMENT,   
size VARCHAR (2),
PRIMARY KEY ( size_id)
)engine = InnoDB;

INSERT INTO Sizes(size) VALUES ("S");
INSERT INTO Sizes(size) VALUES ("M");
INSERT INTO Sizes(size) VALUES ("L");

CREATE TABLE ProductSizes(
product_id INT,
size_id INT,
quantity INT,
price DECIMAL,
PRIMARY KEY (product_id, size_id),
FOREIGN KEY (product_id) REFERENCES Products(product_id),
FOREIGN KEY (size_id) REFERENCES Sizes(size_id)
) engine = InnoDB;

INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (1,1,1,29000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (1,2,1,39000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (1,3,1,45000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (2,1,1,29000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (2,2,1,35000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (2,3,1,39000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (3,1,1,45000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (3,2,1,49000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (3,3,1,55000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (4,1,1,45000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (4,2,1,49000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (4,3,1,55000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (5,1,1,65000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (5,2,1,75000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (5,3,1,79000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (6,1,1,59000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (6,2,1,69000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (6,3,1,75000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (7,1,1,49000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (7,2,1,59000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (7,3,1,65000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (8,1,1,49000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (8,2,1,59000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (8,3,1,65000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (9,1,1,49000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (9,2,1,59000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (9,3,1,65000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (10,1,1,49000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (10,2,1,59000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (10,3,1,65000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (11,1,1,45000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (11,2,1,55000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (11,3,1,65000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (12,1,1,45000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (12,2,1,55000);
INSERT INTO ProductSizes(product_id, size_id, quantity,price) VALUES (12,3,1,65000);


CREATE TABLE ProductUpdates(
staff_id INT AUTO_INCREMENT,
product_id INT,
product_update_id INT,
update_by INT,
create_by INT,
create_at DATETIME,
description VARCHAR(100),
update_at DATETIME,
PRIMARY KEY (staff_id,product_id),
FOREIGN KEY (staff_id) REFERENCES Staffs(staff_id),
FOREIGN KEY (product_id) REFERENCES Products(product_id)
) engine = InnoDB;

CREATE USER IF NOT exists 'hung'@'localhost' IDENTIFIED BY 'Hungnguyen1';
GRANT ALL PRIVILEGES ON *.* TO 'hung'@'localhost' WITH GRANT OPTION;